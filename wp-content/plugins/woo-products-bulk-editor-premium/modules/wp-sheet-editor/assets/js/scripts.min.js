function vgseRange(e,t){for(var o=[],r=e;r<=t;r++)o.push(r);return o}function vgseEscapeHTML(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}function vgseToggleFullScreen(e){jQuery(".wpse-full-screen-notice-content.notice-on").is(":visible")?(jQuery(".wpse-full-screen-notice-content.notice-on").hide(),jQuery(".wpse-full-screen-notice-content.notice-off").show(),jQuery("html").removeClass("wpse-full-screen")):(jQuery(".wpse-full-screen-notice-content.notice-on").show(),jQuery(".wpse-full-screen-notice-content.notice-off").hide(),jQuery("html").addClass("wpse-full-screen"))}function vgseFormatDate(){var e=new Date,t=""+(e.getMonth()+1),o=""+e.getDate(),r=e.getFullYear();return t.length<2&&(t="0"+t),o.length<2&&(o="0"+o),[r,t,o].join("-")}function vgseGuidGenerator(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function vgseCustomTooltip(e,t,o,r){o=o||"bottom",e.tipso({position:o,tooltipHover:!0,content:t}).tipso("show"),r&&(e.hover(function(){e.tipso("hide")}),setTimeout(function(){e.tipso("hide")},8e3)),setTimeout(function(){e.tipso("hide"),r||e.tipso("destroy")},8e3)}function vgseCleanObject(e){for(var t in e)e[t]||delete e[t]}function beParseParams(e){for(var t={},o=e.split("&"),r=0;r<o.length;r++){var n=o[r].split("=");if(n[0]=decodeURIComponent(n[0]),void 0!==t[n[0]]&&vgseEndsWith(n[0],"[]"))if("string"==typeof t[n[0]]&&vgseEndsWith(n[0],"[]")){var a=[t[n[0]],n[1]];t[n[0]]=a}else t[n[0]].push(n[1]);else t[n[0]]=n[1]}return t}function beGetRowsFilters(){return jQuery("body").data("be-filters")?jQuery.param(jQuery("body").data("be-filters")):""}function vgseEndsWith(e,t){return-1!==e.indexOf(t,e.length-t.length)}function beAddRowsFilter(e){if(!e)return!1;var t=jQuery("body").data("be-filters");t=t||{};var o="string"==typeof e?beParseParams(e):e,r=jQuery.extend(t,o);vgseCleanObject(r);var n=jQuery(".vgse-current-filters");return n.find(".button").remove(),n.each(function(){var i=jQuery(this);jQuery.each(r,function(e,t){if(t&&e.indexOf("meta_query")<0){var o="string"==typeof t?t:t.join(", ");20<(o=jQuery("<span>"+o+"</span>").text()).length&&(o=o.substring(0,20)+"...");var r=e.replace("[]","");i.append('<a href="#" class="button" data-filter-key="'+e+'"><i class="fa fa-remove"></i> '+r+": "+o+"</a>")}}),r.meta_query&&jQuery.each(r.meta_query,function(e,t){var o=t.key;if(o){var r=t.value,n=t.compare;20<(r=jQuery("<span>"+r+"</span>").text()).length&&(r=r.substring(0,20)+"..."),i.append('<a href="#" class="button advanced-filter" data-filter-key="meta_query"><i class="fa fa-remove"></i> '+o+" "+n+" "+r+"</a>")}}),jQuery(".advanced-filters-list > li").each(function(){var e=jQuery(this),t=e.find(".wpse-advanced-filters-field-selector"),o=t.val();if(o){var r=t.attr("name"),n=e.find(".wpse-advanced-filters-value-selector").val(),a=e.find(".wpse-advanced-filters-operator-selector option:selected").text(),s="string"==typeof n?n:n.join(", ");20<(s=jQuery("<span>"+s+"</span>").text()).length&&(s=s.substring(0,20)+"..."),i.append('<a href="#" class="button advanced-filter" data-filter-key="'+r+'"><i class="fa fa-remove"></i> '+o+" "+a+" "+s+"</a>")}}),i.find(".button").length?i.show():i.hide()}),1<n.find(".button").length?n.append('<a href="#" class="button advanced-filter remove-all-filters"><i class="fa fa-remove"></i> '+vgse_editor_settings.texts.remove_all_filters+"</a>"):n.find(".remove-all-filters").remove(),jQuery("body").data("be-filters",r),r}function beAjaxLoop(e){var o=jQuery.extend({totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,o){},status:"running"},e);function r(){if(o.current<o.totalCalls+1){if("running"!==o.status)return 1;jQuery.isArray(o.data)?(o.data.push({name:"page",value:o.current}),o.data.push({name:"totalCalls",value:o.totalCalls})):(o.data.page=o.current,o.data.totalCalls=o.totalCalls);var e={url:o.url,dataType:o.dataType,data:o.prepareData(o.data,o),method:o.method};jQuery.ajax(e).done(function(e){o.onSuccess(e,o)&&(o.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))}).fail(function(e,t){o.onError(e,t,o)&&(o.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))})}}return r(),{pause:function(){o.status="paused"},resume:function(){o.status="running",r()}}}function loading_ajax(e){"boolean"==typeof e&&(e={estado:e});var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600,position:"top"};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)var e="green";else if("error"==t.tipo)e="red";else if("warning"==t.tipo)e="orange";else e="blue";"bottom"===t.position?jQuery("#ohsnap").css({top:"auto",bottom:"5px"}):jQuery("#ohsnap").css({top:"",bottom:""}),jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),jQuery("#ohsnap .alert").remove(),ohSnap(t.mensaje,{duration:t.time,color:e})},500)}function beLoadPosts(o,r,n,a){loading_ajax({estado:!0});var t=setTimeout(function(){jQuery(".wpse-stuck-loading").css("display","block")},5e3);n=n||!0,a=a||!1,o.action="vgse_load_data",o.wpse_source_suffix=vgse_editor_settings.wpse_source_suffix||"",o.paged||(o.paged=1),window.beCurrentPage=o.paged,o.filters=beGetRowsFilters(),window.beLastLoadRowsAjax=jQuery.ajax({url:ajaxurl,dataType:"json",type:"POST",data:o}).success(function(e){if(jQuery(".wpse-stuck-loading").hide(),clearTimeout(t),jQuery("body").trigger("vgSheetEditor:beforeRowsInsert",[e,o,r,n,a]),"function"==typeof r&&(r(e),n))return!0;e.success?(vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows,null,a),notification({mensaje:e.data.message||vgse_editor_settings.texts.posts_loaded,tipo:"info"}),loading_ajax({estado:!1})):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info"}),vgseAddFoundRowsCount(0))}).error(function(e,t){100<=vgse_editor_settings.posts_per_page&&(500<=e.status||"timeout"===t)&&(window.vgseDontNotifyServerError=!0,vgse_editor_settings.posts_per_page=10,o.wpse_reset_posts_per_page=vgse_editor_settings.posts_per_page,beLoadPosts(o,r,n,a),setTimeout(function(){loading_ajax({estado:!0})},200))})}function beSetSaveButtonStatus(e){var t=jQuery("#vg-header-toolbar .wpse-save");e?(t.attr("data-remodal-target","bulk-save"),t.removeClass("disabled")):(t.removeAttr("data-remodal-target"),t.addClass("disabled"))}function beDeduplicateItems(e){if(!e||!e.length)return e;var r={},n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,t){var o="array"==n?t[0]:t.ID;"string"==typeof o&&(o=parseInt(o)),r[o]||(r[o]=t)}),r}function beGetModifiedObjectProperties(t,o){var r={};return Object.keys(o).forEach(function(e){"0"===e||t&&void 0!==t[e]&&o[e]==t[e]||(r[e]=o[e])}),r}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var o=e.length;o--;)if(e[o]!==t[o])return!1;return!0}function beGetModifiedItems(n,a){if(!n)n=hot.getSourceData();if(!a)a=window.beOriginalData;n=beDeduplicateItems(n),a=beDeduplicateItems(a);var s=[];return jQuery.each(n,function(e,t){var o,r=beGetModifiedObjectProperties(a[e],n[e]);void 0!==a[e]&&jQuery.isEmptyObject(r)||(o=!a[e]||a[e].provider&&vgse_editor_settings.saveFullRowPostTypes&&-1<vgse_editor_settings.saveFullRowPostTypes.indexOf(a[e].provider)?n[e]:(r.ID=e,r),s.push(o))}),s}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))var e=jQuery(".wp-editor-area").val()||"";else if(document.getElementById("editpost_ifr"))e=(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML;else e="";return e}function vgseExecuteFunctionByName(e,t){e=jQuery.trim(e);for(var o=[].slice.call(arguments).splice(2),r=e.split("."),n=r.pop(),a=0;a<r.length;a++)t=t[r[a]];return t[n].apply(t,o)}function vgObjectToArray(e){var t=[];for(var o in e)t.push(e[o]);return t}function _debounce(t,o,r){var n,a,s,i,u,d=function(){var e=_now()-i;e<o&&0<=e?n=setTimeout(d,o-e):(n=null,r||(u=t.apply(s,a),n||(s=a=null)))};return function(){s=this,a=arguments,i=_now();var e=r&&!n;return n=n||setTimeout(d,o),e&&(u=t.apply(s,a),s=a=null),u}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(o,r,n){var a,s,i;r=r||300;var u=null,d=0;n=n||{};function l(){d=!1===n.leading?0:_now(),u=null,i=o.apply(a,s),u||(a=s=null)}return function(){var e=_now();d||!1!==n.leading||(d=e);var t=r-(e-d);return a=this,s=arguments,t<=0||r<t?(u&&(clearTimeout(u),u=null),d=e,i=o.apply(a,s),u||(a=s=null)):u||!1===n.trailing||(u=setTimeout(l,t)),i}}function vgseRemoveRowFromSheetByID(e){if(e.length){var t=hot.getSourceData();e.forEach(function(e){t=vgseRemovePostFromSheet(e,t)}),hot.loadData(t)}}function vgseRemovePostFromSheet(r,e){var n=[];return r=parseInt(r),e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);"string"==typeof o.ID&&(o.ID=parseInt(o.ID)),r!==o.ID&&n.push(e)}),n}function vgAddRowsToSheet(e,t,o){e=e||[],"prepend"===(t=t||"append")&&(e=e.reverse());var r=hot.getSourceData();o&&e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);o.ID=parseInt(o.ID),r=vgseRemovePostFromSheet(o.ID,r)});var n=r.map(function(e){return e.ID});for(i=0;i<e.length;i++)n.indexOf(e[i].ID)<0&&("append"===t?r.push(jQuery.extend(!0,{},e[i])):r.unshift(jQuery.extend(!0,{},e[i])));hot.loadData(r),jQuery("body").trigger("vgSheetEditor:afterRowsInsert",[e,t,o]),window.beOriginalData||(window.beOriginalData=[]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function wpsePrepareGalleryFilesForCellFormat(e,t){var o=hot.colToProp(t.col),r=vgse_editor_settings.final_spreadsheet_columns_settings[o],n=r&&void 0!==r.wp_media_multiple&&r.wp_media_multiple,a=hot.getDataAtCell(t.row,t.col),s=n&&a?a.split(","):[];jQuery.each(e,function(e,t){s.push(t.url+"?wpId="+t.id)}),hot.setDataAtCell(t.row,t.col,s.join(","))}function vgseInitSelect2(e){if(!e)e=jQuery("select.select2");e.each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0,allowClear:!0};jQuery(this).data("remote")&&(e.ajax={url:ajaxurl,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),global_search:jQuery(this).data("global-search")||"",output_format:jQuery(this).data("output-format"),taxonomies:jQuery(this).data("taxonomies"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery("#vgse-wrapper").data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(e,t){if(e){t=t||vgse_editor_settings.texts.save_changes_reload_optional;var o=hot.getSourceData();if((o=beGetModifiedItems(o,window.beOriginalData)).length)return alert(t),!0}var r=jQuery(".remodal-bg").data("nonce"),n=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:n.data("post-type"),nonce:r})}function vgseAddFoundRowsCount(e){window.beFoundRows=e,jQuery(".be-total-rows").text(jQuery(".be-total-rows").text().replace(/\d+/,e))}function vgseGetRowTitle(e){var t=window.vgseFormulasBulkSelectorExists?2:1;return hot.getDataAtCell(e,t)}function vgseInputToFormattedColumnField(e,o,t){if(void 0!==vgse_editor_settings.final_spreadsheet_columns_settings[e]){var r=vgse_editor_settings.final_spreadsheet_columns_settings[e],n=o.find(t),a=n.attr("name"),s=n.attr("class");if(!n.is("input")&&!n.is("textarea")||n.attr("type")&&"text"!==n.attr("type"))return!0;if(void 0!==r.formatted.editor&&"select"===r.formatted.editor)n.replaceWith('<select class="'+s+'" name="'+a+'"><option value="">('+vgse_editor_settings.texts.empty+")</option></select>"),(i=o.find("select"+t)).each(function(){var o=jQuery(this);jQuery.each(r.formatted.selectOptions,function(e,t){jQuery.isNumeric(e)&&(e=t),o.append('<option value="'+e+'">'+t+"</option>")})});else if(void 0!==r.formatted.type&&"checkbox"===r.formatted.type){n.replaceWith('<input type="checkbox" class="'+s+'" name="'+a+'">'),(i=o.find("input"+t+":checkbox")).change(function(){jQuery(this).is(":checked")?jQuery(this).val(r.formatted.checkedTemplate):jQuery(this).val(r.formatted.uncheckedTemplate)}),i.trigger("change")}else if(void 0!==r.formatted.type&&"date"===r.formatted.type){var i;n.replaceWith('<input type="date" class="'+s+'">'),(i=o.find("input"+t)).after('<input type="hidden" name="'+a+'" class="wpse-hidden-timestamp '+s+'" />'),i.change(function(){var e=jQuery(this).val();if(e)var t=moment.utc(e+" 0:00:00","YYYY-MM-DD H:mm:ss").format(r.formatted.customDatabaseFormat||r.formatted.dateFormat);else t="";o.find(".wpse-hidden-timestamp").val(t)}),i.trigger("change")}}}void 0===Array.prototype.chunk&&Object.defineProperty(Array.prototype,"chunk",{value:function(o){var r=this;return[].concat.apply([],r.map(function(e,t){return t%o?[]:[r.slice(t,t+o)]}))}}),jQuery(document).ajaxError(function(e,t,o,r){loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:"abort"!==t.statusText&&(400==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_400,tipo:"error",tiempo:6e4}):403==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_403,tipo:"error",tiempo:6e4}):500==t.status||502==t.status||505==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}):503==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_503,tipo:"error",tiempo:6e4}):509==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_509,tipo:"error",tiempo:6e4}):504==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_504,tipo:"error",tiempo:6e4}):notification({mensaje:vgse_editor_settings.texts.http_error_default,tipo:"error",tiempo:6e4}))}),jQuery(document).ajaxComplete(function(e,t,o,r){setTimeout(function(){"abort"!==t.statusText&&window.vgse_editor_settings&&("0"!==t.responseText&&0!==t.responseText&&!r||(loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4})))},500)});
jQuery(document).ready(function(e){if(window.wpseHasInitialized)return!0;if(window.wpseHasInitialized=!0,jQuery("body").on("click",".wpse-toggle-head",function(){jQuery(this).next(".wpse-toggle-content").slideToggle()}),!jQuery(".be-spreadsheet-wrapper").length)return!0;var s,_,c,p,l,g;window.vgseFormulasBulkSelectorExists=jQuery(".modal-formula").length,(s=Handsontable.editors.getEditor("chosen")).prototype.prepareOriginalBk=s.prototype.prepare,s.prototype.prepare=function(e,t,o,a,r,n){s.prototype.prepareOriginalBk.apply(this,arguments),this.originalValue=this.originalValue.split(vgse_editor_settings.taxonomy_terms_separator+" ").join(vgse_editor_settings.taxonomy_terms_separator)},s.prototype.getValue=function(){return this.$textarea.val()?"object"==typeof this.$textarea.val()?this.$textarea.val().join(vgse_editor_settings.taxonomy_terms_separator+" "):this.$textarea.val():""},(_=Handsontable).renderers.registerRenderer("wp_media_gallery",function(e,t,o,a,r,n,s){_.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[r],d=void 0!==i.wp_media_multiple&&i.wp_media_multiple,l=parseInt(v.getDataAtRowProp(o,"ID")),u=_.helper.stringify(n),c=[],p=[];u.split(",").forEach(function(e){c.push(jQuery.trim(e.replace(/.+wpId=(\d+)$/,"$1")));var t=e.split("/");p.push(jQuery.trim(t[t.length-1].replace(/(.+)\?wpId=(\d+)$/,"$1")))});var g="";if(u&&u.indexOf(",")<0){var m=u.replace(/\?.+/,"").split("."),y=m[m.length-1].toLowerCase();-1<u.indexOf("http")&&-1<["png","jpg","jpeg","gif"].indexOf(y)&&(g+='<div class="vi-inline-preview-wrapper"><img class="vi-preview-img" src="'+u+'" width="25"></div>')}if(i.formatted.readOnly||(g+='<button class="set_custom_images ',d&&(g+="multiple"),g+=' button" data-type="'+i.data_type+'" data-file="'+c.join(",")+'" data-key="'+r+'" data-id="'+l+'"><i class="fa fa-upload"></i></button>',d&&u&&(g+=' <a href="#image" data-remodal-target="image" class="view_custom_images multiple button" data-type="'+i.data_type+'" data-key="'+r+'" data-id="'+l+'"><i class="fa fa-image"></i></a>')),n){var f=p.join(", ");g+=jQuery("<span>"+f.substring(0,40)+"</span>").text(),40<f.length&&(g+="...")}else g+="("+vgse_editor_settings.texts.empty+")";return i.formatted.readOnly&&(g=(g='<i class="fa fa-lock vg-cell-blocked"></i> '+g).replace(/set_custom_images|view_custom_images/g,"")),t.innerHTML=g,t}),(c=Handsontable).renderers.registerRenderer("wp_tinymce",function(e,t,o,a,r,n,s){c.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[r];void 0===i.formatted.wpse_template_key&&(i.formatted.wpse_template_key="tinymce_cell_template");var d=vgse_editor_settings[i.formatted.wpse_template_key],l=parseInt(v.getDataAtRowProp(o,"ID")),u=vgseGetRowTitle(o);if(d=(d=(d=d.replace(/\{key\}/g,r)).replace(/\{type\}/g,i.data_type)).replace(/\{id\}/g,l),"string"==typeof u)d=d.replace(/\{post_title\}/g,u.replace(/"/g,""));if(n){d+=jQuery("<span>"+n+"</span>").text().substring(0,30),30<n.length&&(d+="...")}else d+="("+vgse_editor_settings.texts.empty+")";return i.formatted.readOnly&&(d=(d='<i class="fa fa-lock vg-cell-blocked"></i> '+d).replace(/btn-popup-content/g,"")),t.innerHTML=d,t}),(p=Handsontable).renderers.registerRenderer("wp_handsontable",function(e,t,o,a,r,n,s){p.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[r],d=vgse_editor_settings.handsontable_cell_template,l=parseInt(v.getDataAtRowProp(o,"ID")),u=(d=(d=(d=(d=d.replace(/\{key\}/g,r)).replace(/\{type\}/g,i.data_type)).replace(/\{id\}/g,l)).replace(/\{post_title\}/g,vgseGetRowTitle(o).replace(/"/g,"")),v.getSourceData()),c=jQuery.extend(!0,i,u[o]);return c.post_id=l,d=(d=(d=d.replace(/\{modal_settings\}/g,vgseEscapeHTML(JSON.stringify(c)))).replace(/\{value\}/g,vgseEscapeHTML(JSON.stringify(n)))).replace(/\{button_label\}/g,c.edit_button_label),d+=n&&"[]"!==n?" ...":" ("+vgse_editor_settings.texts.empty+")",i.formatted.readOnly&&(d=(d='<i class="fa fa-lock vg-cell-blocked"></i> '+d).replace(/(btn-popup-content|button-custom-modal-editor|button-handsontable)/g,"")),t.innerHTML=d,t}),(l=Handsontable).renderers.registerRenderer("wp_external_button",function(e,t,o,a,r,n,s){l.renderers.BaseRenderer.apply(this,arguments);var i=vgse_editor_settings.final_spreadsheet_columns_settings[r];if(n)var d='<a target="_blank" href="'+n+'" class="button"><i class="fa fa-external-link"></i> '+i.title+"</a>";else d="";return t.innerHTML=d,t}),(g=Handsontable).renderers.registerRenderer("wp_locked",function(e,t,o,a,r,n,s){g.renderers.BaseRenderer.apply(this,arguments);var i=jQuery("#post-data").data("post-type"),d=vgse_editor_settings.final_spreadsheet_columns_settings[r];if(d.lock_template_key||(d.lock_template_key="lock_cell_template"),"string"==typeof n){var l=vgse_editor_settings.is_premium?120:55;(n=jQuery("<span>"+n+"</span>").text().substring(0,l)).length>l&&(n+="...")}if("string"==typeof n&&-1<n.indexOf("vg-cell-blocked"))var u=n;else u=(u=(u=(u=(u=vgse_editor_settings[d.lock_template_key]).replace(/\{key\}/g,r)).replace(/\{value\}/g,n)).replace(/\{post_type\}/g,i)).replace(/set_custom_images|view_custom_images|button-handsontable|button-custom-modal-editor|data-remodal-target="image"/g,"");return t.innerHTML=u,t}),jQuery(".wpse-full-screen-notice").length&&(vgseToggleFullScreen(),jQuery(".wpse-full-screen-notice-content .wpse-full-screen-toggle").click(function(e){e.preventDefault(),vgseToggleFullScreen()}));jQuery("body").on("click",".dismiss-review-tip",function(e){jQuery(this).attr("href")||e.preventDefault(),vgse_editor_settings.texts.ask_review="",jQuery(this).parent(".review-tip").remove();var t=jQuery(".remodal-bg").data("nonce");jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"vgse_dismiss_review_tip",nonce:t},dataType:"json"})}),jQuery(".wpse-stuck-loading").appendTo("body"),jQuery("body").on("click",".wpse-stuck-loading button",function(e){e.preventDefault(),loading_ajax(!1),window.beLastLoadRowsAjax&&window.beLastLoadRowsAjax.abort(),jQuery(".wpse-stuck-loading").hide()}),vgse_editor_settings.user_has_saved_sheet||vgseCustomTooltip(jQuery(".vg-toolbar .settings-container"),vgse_editor_settings.texts.settings_moved_submenu,"top"),jQuery(".vi-preview-wrapper").appendTo("body"),jQuery("body").on("mouseleave",".vi-preview-img",function(e){jQuery(".vi-preview-wrapper").hide()}),jQuery("body").on("mouseenter",".vi-preview-img",function(e){var t=jQuery(this).first();jQuery(this)[0].outerHTML;if(-1<t.attr("src").indexOf("wpse_no_zoom"))return!0;var o='<img src="'+t.attr("src")+'" />',a=jQuery(".vi-preview-wrapper");jQuery(window).width()-a.width()<t.offset().left+t.width()-jQuery(document).scrollLeft()?a.css({right:"auto",left:"0px"}):a.css({right:"0px",left:"auto"}),a.empty(),a.show(),a.append(o)}),jQuery("#go-top").click(function(e){e.preventDefault(),jQuery("html, body").stop().animate({scrollTop:0},"300","swing",function(){})}),jQuery("body").append('<div id="ohsnap" style="z-index: -1"></div>');var t=jQuery("#vgse-wrapper");t.length&&t.find(".vg-toolbar input:checkbox").labelauty(),jQuery("body").find(".tipso").tipso({size:"small",tooltipHover:!0,background:"#444444"});var v,r=jQuery("#post-data"),o=(jQuery("#responseConsole"),jQuery("#vgse-wrapper"));format=!jQuery("#formato").is(":checked"),setTimeout(function(){vgseInitSelect2()},2e3);var a={comments:!0,colWidths:vgObjectToArray(vgse_editor_settings.colWidths),colHeaders:vgObjectToArray(vgse_editor_settings.colHeaders),columns:m(format),rowHeaders:!0,startRows:vgse_editor_settings.startRows,startCols:vgse_editor_settings.startCols,currentRowClassName:"currentRow",currentColClassName:"currentCol",fillHandle:!1,columnSorting:!0,manualColumnFreeze:!0,manualColumnMove:!0,contextMenu:{items:{undo:{},redo:{},separator1:{name:"---------"},copy:{},cut:{},how_to_paste:{name:vgse_editor_settings.texts.how_to_paste},separator2:{name:"---------"},make_read_only:{},freeze_column:{},unfreeze_column:{},resize_columns:{name:vgse_editor_settings.texts.auto_resize_columns,callback:function(e,t,o){v.updateSettings({colWidths:null}),v.updateSettings({autoColumnSize:!0});var a=v.getPlugin("autoColumnSize");a.recalculateAllColumnsWidth(),a.widths;var r=[];a.widths.forEach(function(e){r.push(e+25)}),v.updateSettings({colWidths:r,autoColumnSize:!1}),v.runHooks("afterColumnResize")}},delete_row:{name:vgse_editor_settings.texts.delete_row,callback:function(e,t,o){if(!confirm(vgse_editor_settings.texts.confirm_delete_row))return!0;var a=[],r=[];t.forEach(function(e){e.start.row<e.end.row?vgseRange(e.start.row,e.end.row).forEach(function(e){r.push(e)}):r.push(e.start.row)}),r.forEach(function(e){a.push(v.getDataAtRowProp(e,"ID"))}),loading_ajax(!0),jQuery.post(ajaxurl,{action:"vgse_delete_row_ids",nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:vgse_editor_settings.post_type,ids:a},function(e){loading_ajax(!1),e.success?(notification({mensaje:e.data.message}),vgseRemoveRowFromSheetByID(a)):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})})}}}},autoWrapRow:!0,autoRowSize:!1,autoColumnSize:!1,viewportRowRenderingOffset:20,viewportColumnRenderingOffset:4,wordWrap:!0,minSpareCols:0,minSpareRows:0,width:null,height:null,copyRowsLimit:99999999,copyColsLimit:99999999,afterChange:_throttle(function(e){var t=!1;e&&e.length&&e.forEach(function(e){return!(!window.vgseFormulasBulkSelectorExists||0!==e[1])||(e[2]!==e[3]?t=!0:void 0)}),t&&beSetSaveButtonStatus(!0)},3e3,{leading:!0,trailing:!0}),beforeCopy:function(a,e){return a.forEach(function(e,o){e.forEach(function(e,t){"string"==typeof e&&-1<e.indexOf("vg-cell-blocked")&&(a[o][t]=jQuery.trim(jQuery("<span>"+e+"</span>").text()))})}),a}};vgse_editor_settings.debug&&(a.debug=vgse_editor_settings.debug);var n=vgse_editor_settings.custom_handsontable_args?JSON.parse(vgse_editor_settings.custom_handsontable_args):{},i=jQuery.extend(a,n);v=new Handsontable(r[0],i),beSetSaveButtonStatus(!1),window.hot=v,window.beFoundRows=0,o.find("button[name=load]").click(function(){var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:r.data("post-type"),nonce:e})}),vgse_editor_settings.disable_automatic_loading_rows||setTimeout(function(){o.find("button[name=load]").click()},400),jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,t){t.success||vgseCustomTooltip(jQuery("#addrow"),vgse_editor_settings.texts.add_posts_here)}),jQuery(".bulk-save.remodal").find(".remodal-cancel").click(function(e){jQuery('[data-remodal-id="bulk-save"]').remodal().close(),jQuery("html,body").scrollLeft(0)}),jQuery(".bulk-save.remodal .bulk-saving-screen").find(".remodal-cancel").click(function(e){jQuery("html,body").scrollLeft(0);var t=jQuery(this),o=t.parents(".remodal");o.find(".be-saving-warning").show(),o.find(".bulk-saving-screen").hide(),o.find("#be-nanobar-container").empty(),t.addClass("hidden"),o.find(".response").empty()}),jQuery(document).on("opening",'[data-remodal-id="bulk-save"]',function(){vgse_editor_settings.user_has_saved_sheet&&jQuery("body").find(".be-start-saving").click()}),jQuery("body").on("click",".wpse-save.disabled",function(e){e.preventDefault(),notification({mensaje:vgse_editor_settings.texts.no_changes_to_save,tipo:"info"})}),jQuery(".bulk-save.remodal").find(".remodal-confirm").click(function(e){var t=jQuery(this).parents(".remodal");t.find(".be-saving-warning").show(),t.find(".bulk-saving-screen").hide(),t.find("#be-nanobar-container").empty(),t.find(".response").empty()}),jQuery("body").find(".be-start-saving").click(function(e){e.preventDefault(),vgse_editor_settings.user_has_saved_sheet=1;var t=jQuery(this).parents(".be-saving-warning"),n=t.next();n.find(".be-loading-anim").show(),t.fadeOut(),n.fadeIn();var o=jQuery(".remodal-bg").data("nonce"),a={classname:"be-progress-bar",id:"be-progress-bar",target:document.getElementById("be-nanobar-container")},s=new Nanobar(a);s.go(1);var i=v.getSourceData();if(i=beGetModifiedItems(i,window.beOriginalData),jQuery(".saving-now-message").show(),setTimeout(function(){jQuery(".saving-complete-message").length||jQuery(".tip-saving-speed-message").show()},5500),!i.length)return jQuery(n).find(".response").append("<p>"+vgse_editor_settings.texts.no_changes_to_save+"</p>"),loading_ajax({estado:!1}),beSetSaveButtonStatus(!1),n.find(".remodal-cancel").removeClass("hidden"),n.find(".be-loading-anim").hide(),setFormSubmitting(),!0;beAjaxLoop({totalCalls:Math.ceil(i.length/parseInt(vgse_editor_settings.save_posts_per_page)),url:ajaxurl,dataType:"json",method:"POST",data:{data:[],post_type:r.data("post-type"),action:"vgse_save_data",nonce:o,filters:beGetRowsFilters(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""},prepareData:function(e,t){var o=i.chunk(parseInt(vgse_editor_settings.save_posts_per_page));return e.data=o[t.current-1],e},onSuccess:function(e,t){if(e&&(!0===e.success||e.data)||(e={data:{message:vgse_editor_settings.texts.http_error_try_now},success:!1,allowRetry:!0}),!e.success)return jQuery(".tip-saving-speed-message").hide(),jQuery(n).find(".response").append("<p>"+e.data.message+"</p>"),!!e.allowRetry&&confirm(e.data.message)?(t.current--,jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(jQuery(n).find(".response").append(vgse_editor_settings.texts.saving_stop_error),n.find(".remodal-cancel").removeClass("hidden"),n.find(".be-loading-anim").hide(),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!1);s.go(t.current/t.totalCalls*100),e.data.deleted.length&&vgseRemoveRowFromSheetByID(e.data.deleted);var o=parseInt(vgse_editor_settings.save_posts_per_page)*t.current>i.length?i.length:parseInt(vgse_editor_settings.save_posts_per_page)*t.current,a=(a=vgse_editor_settings.texts.paged_batch_saved.replace("{updated}",o)).replace("{total}",i.length);if(jQuery(n).find(".response").append("<p>"+a+"</p>"),t.current===t.totalCalls){jQuery(".tip-saving-speed-message, .saving-now-message").hide();var r=vgse_editor_settings.texts.everything_saved;vgse_editor_settings.texts.ask_review&&(r+="<br>"+vgse_editor_settings.texts.ask_review),jQuery(n).find(".response").empty().append('<p class="saving-complete-message">'+r+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.everything_saved}),n.find(".remodal-cancel").removeClass("hidden"),n.find(".be-loading-anim").hide(),jQuery("body").trigger("vgSheetEditor/afterSavingChanges"),setFormSubmitting(),beSetSaveButtonStatus(!1),window.beOriginalData=jQuery.extend(!0,[],v.getSourceData()),v.getSourceData().forEach(function(e,t){void 0!==e.post_status&&"delete"===e.post_status&&v.alter("remove_row",t)})}return setTimeout(function(){jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight)},600),!0},onError:function(e,t,o){var a=confirm(vgse_editor_settings.texts.http_error_try_now);return n.find(".be-loading-anim").hide(),a?(window.vgseDontNotifyServerError=!0,o.current--,s.go(o.current/o.totalCalls*100),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(jQuery(n).find(".response").append(vgse_editor_settings.texts.saving_stop_error),n.find(".remodal-cancel").removeClass("hidden"),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!1)}})}),"undefined"!=typeof wp&&wp.media&&jQuery("body").delegate(".set_custom_images:not(.multiple)","click",function(e){e.preventDefault(),loading_ajax({estado:!0});var a=jQuery(this),t=a.parent("td"),r=v.getCoords(t[0]),n=jQuery("html,body").scrollLeft(),o=(a.data("id"),a.data("key"),a.data("type"),a.data("file")),s=[],i=jQuery(document).scrollTop(),d=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!1}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),o=e.props.toJSON();o.url=o.url||"","image"===t&&o.url&&wpsePrepareGalleryFilesForCellFormat([{url:o.url,id:o.url}],r)}),media_uploader.on("open",function(){var e=media_uploader.state().get("selection");o&&e.add(wp.media.attachment(o))}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(n),jQuery(window).scrollTop(i),jQuery("#infinito").prop("checked",d)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(n);var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models;if(!t.length)return!0;for(var o=0;o<e;o++)s.push({url:t[o].attributes.url,id:t[o].id});a.data("file",t[0].id),wpsePrepareGalleryFilesForCellFormat(s,r)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),"undefined"!=typeof wp&&wp.media&&jQuery("body").delegate(".set_custom_images.multiple","click",function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this),o=t.parent("td"),a=v.getCoords(o[0]),r=jQuery("html,body").scrollLeft(),n=(t.data("id"),t.data("key"),t.data("type"),[]),s=jQuery(document).scrollTop(),i=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!0}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),o=e.props.toJSON();o.url=o.url||"","image"===t&&o.url&&wpsePrepareGalleryFilesForCellFormat([{url:o.url,id:o.url}],a)}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(r),jQuery(window).scrollTop(s),jQuery("#infinito").prop("checked",i)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(r);for(var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models,o=0;o<e;o++)n.push({url:t[o].attributes.url,id:t[o].id});wpsePrepareGalleryFilesForCellFormat(n,a)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),jQuery("body").delegate(".view_custom_images","click",function(){var e=jQuery(this).parent("td"),t=v.getCoords(e[0]),o=v.getDataAtCell(t.row,t.col),a="";o.split(",").forEach(function(e){a+='<div><img src="'+jQuery.trim(e)+'" width="425px" /></div>'}),jQuery("div[data-remodal-id=image] .modal-content").html(a),jQuery("[data-remodal-id=image]").remodal()}),jQuery("button.siguiente").click(function(){var e=jQuery(this),t=e.data("pos"),o=e.parents(".remodal-wrapper").find(".remodal-confirm.guardar-popup-tinymce").data("key");jQuery(".btn-popup-content.button-tinymce-"+o).eq(t).trigger("click")}),jQuery("button.anterior").click(function(){var e=jQuery(this),t=e.data("pos"),o=e.parents(".remodal-wrapper").find(".remodal-confirm.guardar-popup-tinymce").data("key");jQuery(".btn-popup-content.button-tinymce-"+o).eq(t).trigger("click")}),jQuery("body").delegate(".btn-popup-content","click",function(){var e=jQuery(this),t=e.data("id"),o=e.data("key"),a=e.data("type"),r=e.parents("tr").index(),n=e.parents("tbody").find("tr").length,s=jQuery(this).parent("td"),i=v.getCoords(s[0]),d=v.getDataAtCell(i.row,i.col),l=vgseGetRowTitle(i.row);window.tinymceAutoResized||(window.tinymceAutoResized=!0,jQuery("#editpost_ifr").height(200)),0===r?(jQuery("button.anterior").hide(),jQuery("button.anterior").next(".tipso").hide()):(jQuery("button.anterior").show(),jQuery("button.anterior").next(".tipso").show()),r===n-1?(jQuery("button.siguiente").hide(),jQuery("button.siguiente").next(".tipso").hide()):(jQuery("button.siguiente").show(),jQuery("button.siguiente").next(".tipso").show()),jQuery("button.anterior").data("pos",r-1),jQuery("button.siguiente").data("pos",r+1),l?jQuery(".modal-tinymce-editor .post-title-modal span").text(l).show():jQuery(".modal-tinymce-editor .post-title-modal").hide(),setTimeout(function(){"none"!==jQuery(".wp-editor-area").css("display")?(jQuery(".wp-editor-area").empty(),jQuery(".wp-editor-area").val(d)):document.getElementById("editpost_ifr")&&((document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML=d);window.originalTinyMCEData=beGetTinymceContent(),jQuery(".remodal2 .remodal-confirm").data("post_id",t),jQuery(".remodal2 .remodal-confirm").data("key",o),jQuery(".remodal2 .remodal-confirm").data("type",a),jQuery(".remodal2 .remodal-confirm").data("cellCoords",i),jQuery('[data-remodal-id="editor"]').remodal().open()},500)}),jQuery(".guardar-popup-tinymce").click(function(e){var t=jQuery(".remodal2 .remodal-confirm").data("cellCoords"),o=beGetTinymceContent();v.setDataAtCell(t.row,t.col,o)}),o.find("button[name=mas]").click(function(){format=!!jQuery("#formato").is(":checked");var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:r.data("post-type"),paged:window.beCurrentPage+1,nonce:e},function(e){if(e.success){vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows),loading_ajax({estado:!1});var t=e.data.message||vgse_editor_settings.texts.posts_loaded;notification({mensaje:t}),window.scrroll=!0,e.data&&e.data.rows.length||(window.scrroll=!1)}else loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info",time:3e4}),window.scrroll=!1})});jQuery("#post-data").offset();window.scrroll=!0,window.isAddColumnNotified=!1;v.countRows();var d=jQuery(".ht_clone_top").width()>jQuery(window).width(),u=jQuery(document).width()+200>jQuery(window).width();function m(e){if(!0===e)var t=vgse_editor_settings.columnsFormat;else t=vgse_editor_settings.columnsUnformat;var o=vgObjectToArray(t);return o.forEach(function(e,t){"string"==typeof e.source&&("loadTaxonomyTerms"===e.source&&(o[t].source=_throttle(function(e,t){return function(t){var e=jQuery(".remodal-bg").data("nonce"),o=jQuery("#post_type_new_row").val(),a=v.colToProp(v.getSelected()[0][1]),r=vgse_editor_settings.columnsFormat[a].taxonomy_key||a;void 0===window.wpseTaxonomyTerms&&(window.wpseTaxonomyTerms={});void 0===window.wpseTaxonomyTerms[r]?(window.wpseTaxonomyTerms[r]=[],jQuery.ajax({url:ajaxurl,dataType:"json",data:{action:"vgse_get_taxonomy_terms",taxonomy_key:r,nonce:e,post_type:o,wpse_source:"taxonomy_column"},success:function(e){window.wpseTaxonomyTerms[r]=e.data,t(e.data)}})):t(window.wpseTaxonomyTerms[r])}(t)},1500,{leading:!0,trailing:!0})),"searchPostByKeyword"===e.source&&(o[t].source=_throttle(function(e,t){return o=e,a=t,r=jQuery(".remodal-bg").data("nonce"),n=jQuery("#post_type_new_row").val(),void jQuery.ajax({url:ajaxurl,dataType:"json",data:{action:"vgse_find_post_by_name",search:o,nonce:r,post_type:n,wpse_source:"post_dropdown_column"},success:function(e){var t=[];e.success&&e.data.data.forEach(function(e){t.push(e.title)}),a(t)}});var o,a,r,n},1500,{leading:!0,trailing:!0})),"searchUsers"===e.source&&(o[t].source=_throttle(function(e,t){return o=e,a=t,r=jQuery(".remodal-bg").data("nonce"),n=jQuery("#post_type_new_row").val(),void jQuery.ajax({url:ajaxurl,dataType:"json",data:{action:"vgse_find_users_by_keyword",search:o,nonce:r,post_type:n,wpse_source:"users_dropdown_column"},success:function(e){var t=[];e.success&&(t=e.data.data),a(t)}});var o,a,r,n},1500,{leading:!0,trailing:!0})))}),o}function y(e){var t=jQuery(window).scrollTop(),o=scrollDown("menu"+e),a=jQuery(window).scrollLeft();o&&"top"===e&&(h<t?(j.removeClass("sticky-left"),j.css({left:"",width:""}),j.removeClass("sticky-left"),j.css("top",""),j.addClass("sticky"),jQuery("#wpadminbar").hide(),b.height(f)):(jQuery("#wpadminbar").show(),j.removeClass("sticky"),b.height(0))),o||"top"===e||(0===t&&(jQuery("#wpadminbar").show(),j.removeClass("sticky"),b.height(0)),j.hasClass("sticky")?(j.css({left:"",width:""}),j.removeClass("sticky-left")):w+20<a?(b.height(f),j.addClass("sticky-left"),j.css({left:a-jQuery("#vgse-wrapper").offset().left,width:jQuery(window).width()})):(b.height(0),j.css({left:"",width:""}),j.removeClass("sticky-left")))}if(jQuery(window).on("scroll",_throttle(function(){var e=scrollDown("infiniteLoad");jQuery("#infinito").is(":checked")&&jQuery(document).height()>jQuery(window).height()&&void 0!==window.beOriginalData&&jQuery(window).scrollTop()+jQuery(window).height()==jQuery(document).height()&&!0===window.scrroll&&e&&(jQuery('button[name="mas"]').trigger("click"),window.scrroll=!1);var t=jQuery(window).scrollLeft()+jQuery(window).width()>=jQuery(document).width()-400;d&&vgse_editor_settings.texts.hint_missing_column_on_scroll&&u&&t&&!window.isAddColumnNotified&&!e&&(window.isAddColumnNotified=!0,notification({mensaje:vgse_editor_settings.texts.hint_missing_column_on_scroll,tipo:"info",time:8e4,position:"bottom"}))},500,{leading:!0,trailing:!0})),jQuery("body").on("click",".show-column-missing-tips",function(e){e.preventDefault(),setTimeout(function(){jQuery(".modal-columns-visibility").parent().scrollTop(jQuery(".missing-column-tips").offset().top)},250)}),jQuery("body").on("click",".wpse-enable-locked-cell",function(e){e.preventDefault();var t=v.colToProp(v.getSelected()[0][1]);vgse_editor_settings.lockedColumnsManuallyEnabled.push(t);var o=v.propToCol(t),a=v.getDataAtCell(1,o);v.setDataAtCell(1,o,a)}),jQuery("#formato").change(function(){format=!jQuery(this).is(":checked");var e=m(format);"function"==typeof vgseColumnsVisibilityUpdateHOT&&window.vgseColumnsVisibilityUsed?vgseColumnsVisibilityUpdateHOT(e,vgse_editor_settings.colHeaders,vgse_editor_settings.colWidth,"softUpdate"):v.updateSettings({columns:e})}),setInterval(function(){var e=v.countRows();jQuery('input[name="visibles"]').val(e)},1e3),jQuery("#addrow").click(function(){var e=jQuery(".remodal-bg").data("nonce"),t=jQuery("#post_type_new_row").val(),o=jQuery(this).next(".number_rows").length&&jQuery(this).next(".number_rows").val()?parseInt(jQuery(this).next(".number_rows").val()):1,a=void 0!==window.wpseAddRowExtraData?window.wpseAddRowExtraData:null;loading_ajax({estado:!0}),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"vgse_insert_individual_post",nonce:e,post_type:t,rows:o,extra_data:a},dataType:"json",success:function(e){e.success?(vgseAddFoundRowsCount(window.beFoundRows+parseInt(o)),vgAddRowsToSheet(e.data.message,"prepend"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.new_rows_added}),jQuery(window).scrollTop(jQuery(".be-spreadsheet-wrapper").offset().top-jQuery("#vg-header-toolbar").height()-20)):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})),jQuery("body").trigger("vgSheetEditor:afterNewRowsInsert",[e,t,o])}})}),jQuery("#addrow2").click(function(){jQuery("#addrow").trigger("click")}),jQuery("#vg-header-toolbar").length&&window.location.href.indexOf("wpse_no_sticky_toolbar")<0){var f=jQuery("#vg-header-toolbar").outerHeight(),w=jQuery("#vg-header-toolbar").offset().left,h=jQuery("#vg-header-toolbar-placeholder").offset().top,j=jQuery("#vg-header-toolbar"),b=jQuery("#vg-header-toolbar-placeholder");jQuery(window).scroll(_throttle(function(){y("top")},20)),jQuery(window).scroll(_throttle(function(){y("left")},5)),y("top"),y("left")}jQuery("body").trigger("vgSheetEditor:afterInit")});var lastScrollTop={};function scrollDown(e){lastScrollTop[e]||(lastScrollTop[e]=0);var t=jQuery(window).scrollTop();return down=t!==lastScrollTop[e],lastScrollTop[e]=t,down}var formSubmitting=!1,setFormSubmitting=function(){formSubmitting=!0};function initHandsontableForPopup(e,t){if(e=e||[],"handsontable"===t.type){var o,a=t.handsontable_column_widths[t.post_type],r=t.handsontable_column_names[t.post_type],n=t.handsontable_columns[t.post_type],s=document.getElementById("handsontable-in-modal");window.hotAttr&&window.hotAttr.destroy(),!(o=e.custom_handsontable_args?e.data:e).length&&window.wpseCurrentPopupSourceCoords.cellValue&&(o=window.wpseCurrentPopupSourceCoords.cellValue);var i={data:o,minSpareRows:1,wordWrap:!0,colWidths:a,allowInsertRow:!0,columnSorting:!0,colHeaders:r,columns:n},d=jQuery.extend(i,e.custom_handsontable_args);window.hotAttr=new Handsontable(s,d)}else if("metabox"===t.type){var l=jQuery(".vgca-iframe-wrapper iframe");l.parents(".vgca-iframe-wrapper ").show(),l.attr("src",l.data("src")+t.post_id+"&wpse_column="+t.key),initEditorIframe(t)}loading_ajax({estado:!1})}function initEditorIframe(s){window.$iframeWrappers=jQuery(".vgca-iframe-wrapper "),window.vgcaIsFrontendSession=[],$iframeWrappers.each(function(){var r=jQuery(this),n=r.find("iframe");window.location.hash;n.data("lastPage",n.contents().get(0).location.href),window.vgcaIsFrontendSession.push(setInterval(function(){var e=n.contents().get(0).location.href;e!==n.data("lastPage")&&($iframeWrappers.css("height",""),n.css("height",""),n.data("lastPage",e));var t=null;try{t=n.contents()}catch(e){}if(t){var o=t.height();n.height(o),r.height(o);var a=t.find(s.metabox_show_selector);a.removeClass("acf-hidden").removeClass("hidden").attr("hidden","").attr("style","display: block !important; visibility: 1 !important; opacity: 1 !important;"),a.siblings().filter(function(){return!(jQuery(this).hasClass("mce-container")||jQuery(this).hasClass("ui-autocomplete")||jQuery(this).attr("id")&&-1<jQuery(this).attr("id").indexOf("__wp-uploader-id"))}).attr("style","display: none !important"),a.parents().each(function(){jQuery(this).siblings().filter(function(){return!(jQuery(this).hasClass("mce-container")||jQuery(this).hasClass("ui-autocomplete")||jQuery(this).attr("id")&&-1<jQuery(this).attr("id").indexOf("__wp-uploader-id"))}).attr("style","display: none !important")})}},1e3))})}function vgsePostTypeSaved(e){e.response.success&&(jQuery(".post-types-form .post-type-field").first().before('<div class="post-type-field"><input type="radio" name="post_types[]" value="'+e.response.data.slug+'" id="'+e.response.data.slug+'"> <label for="'+e.response.data.slug+'">'+e.response.data.label+"</label></div>"),jQuery(".post-types-form input:radio").first().prop("checked",!0),jQuery(".post-types-form .save-trigger").trigger("click"))}function vgsePostTypeSetupPostTypesSaved(e){var t=e.form.parents("li");t.hide();var o=t.next();o.show(),o.hasClass("setup_columns")&&jQuery.get(ajaxurl,{action:"vgse_post_type_setup_columns_visibility",nonce:jQuery(".post-type-setup-wizard").data("nonce"),post_type:jQuery(".post-types-form input:radio:checked").val()},function(e){o.append(e.data.html),o.find('[name="save_post_type_settings"]').prop("checked",!0),"undefined"!=typeof vgseColumnsVisibilityInit&&vgseColumnsVisibilityInit()})}function vgsePostTypeSetupColumnSaved(e){jQuery("#vgse-columns-enabled").append('<li><span class="handle">::</span> '+e.response.data.label+' <input type="hidden" name="columns[]" class="js-column-key" value="'+e.response.data.key+'"><input type="hidden" name="columns_names[]" class="js-column-title" value="'+e.response.data.label+'"></li>')}function vgsePostTypeSetupColumnsVisibilitySaved(e){window.location.href=e.response.data.post_type_editor_url}jQuery(window).on("beforeunload",function(){if(jQuery(".be-spreadsheet-wrapper").length)var e=beGetModifiedItems(hot.getSourceData(),window.beOriginalData);else e=[];if(jQuery(".be-spreadsheet-wrapper").length&&e.length&&!formSubmitting)return vgse_editor_settings.texts.save_changes_on_leave}),jQuery(document).ready(function(){var e=jQuery(".quick-setup-page-content");if(!e.length)return!0;function n(){jQuery(".setup-step.active").removeClass("active").next().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").next().addClass("active")}e.find(".step-back").click(function(e){e.preventDefault(),jQuery(".setup-step.active").removeClass("active").prev().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").prev().addClass("active")}),e.find(".save-all-trigger").click(function(e){e.preventDefault();var t=jQuery(this).parents(".setup-step"),o=t.find("form");if(loading_ajax({estado:!0}),!o.length)return n(),loading_ajax({estado:!1}),!0;t.find(".save-trigger").each(function(){jQuery(this).trigger("click")});var a=t.find(".save-trigger").length,r=setInterval(function(){t.find(".save-trigger").filter(function(){return"yes"===jQuery(this).data("saved")}).length===a&&(clearInterval(r),n(),loading_ajax({estado:!1}))},800)}),e.find(".save-trigger").click(function(e){e.preventDefault();var t=jQuery(this),o=t.parents("form"),a=o.data("callback");jQuery.post(o.attr("action"),o.serializeArray(),function(e){t.data("saved","yes"),a&&vgseExecuteFunctionByName(a,window,{response:e,form:o})})})}),jQuery(document).ready(function(){jQuery("body").on("click",".form-submit-outside",function(e){e.preventDefault(),jQuery(this).parents(".remodal").find("form .form-submit-inside").trigger("click")}),jQuery(document).on("opened",".remodal",function(e){var t=jQuery(document).scrollTop(),o=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1),jQuery("body").data("temp-status",o).data("temp-scrolltop",t);var a=jQuery("html,body").scrollLeft();jQuery("body").data("temp-scrollleft",a)}),jQuery(document).on("closed",".remodal",function(){var e=jQuery("body").data("temp-scrolltop"),t=jQuery("body").data("temp-scrollleft"),o=jQuery("body").data("temp-status");e&&jQuery(window).scrollTop(e),t&&jQuery("html,body").scrollLeft(t),o&&jQuery("#infinito").prop("checked",o)})}),jQuery(document).ready(function(){jQuery("body").on("click",".button-custom-modal-editor",function(e){e.preventDefault();var t,o=jQuery(this),a=o.data(),r=o.parent("td");if(r.length){var n=hot.getCoords(r[0]);if(window.wpseCurrentPopupSourceCoords=n,a.modalSettings.use_new_handsontable_renderer){var s=hot.getDataAtCell(window.wpseCurrentPopupSourceCoords.row,window.wpseCurrentPopupSourceCoords.col);window.wpseCurrentPopupSourceCoords.cellValue=s?JSON.parse(s):{}}}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[a.modalSettings.post_id]||(window.hotModalCache[a.modalSettings.post_id]={}),t=window.hotModalCache&&window.hotModalCache[a.modalSettings.post_id][a.modalSettings.edit_modal_save_action]?window.hotModalCache[a.modalSettings.post_id][a.modalSettings.edit_modal_save_action]:a.existing;var i={button:o,modalSettings:a.modalSettings,existing:"string"==typeof t?JSON.parse(t):t};"string"==typeof i.existing&&(i.existing=JSON.parse(i.existing)),window.vgseWCAttsCurrent=i;jQuery(".custom-modal-editor").remodal().open();jQuery(".custom-modal-editor").addClass("modal-editor-"+a.modalSettings.key)}),jQuery("body").on("click",".custom-modal-editor .remodal-cancel",function(e){var t=jQuery(this).parents(".custom-modal-editor"),o=window.vgseWCAttsCurrent;o.modalSettings.edit_modal_cancel_action&&(loading_ajax({estado:!0}),o.modalSettings.edit_modal_cancel_action.replace("js_function_name:","").split(",").forEach(function(e){vgseExecuteFunctionByName(e,t.find("iframe")[0].contentWindow)}),loading_ajax(!1))}),jQuery("body").on("click",".custom-modal-editor .save-changes-handsontable",function(e){var o=jQuery(this).parents(".custom-modal-editor"),a=jQuery(".remodal-bg").data("nonce"),r=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),"handsontable"===r.modalSettings.type)var n=hotAttr.getSourceData();else if("metabox"===r.modalSettings.type)if(-1<r.modalSettings.metabox_value_selector.indexOf("js_function_name:")){var t=r.modalSettings.metabox_value_selector.replace("js_function_name:","");n=vgseExecuteFunctionByName(t,o.find("iframe")[0].contentWindow)}else{var s=o.find("iframe").contents().find(r.modalSettings.metabox_value_selector);n=1===s.length?s.val():beParseParams(s.serialize())}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[r.modalSettings.post_id]||(window.hotModalCache[r.modalSettings.post_id]={}),r.modalSettings.edit_modal_get_action||(r.button.data("existing",n),window.hotModalCache[r.modalSettings.post_id][r.modalSettings.edit_modal_save_action]=n),"handsontable"===r.modalSettings.type&&r.modalSettings.use_new_handsontable_renderer&&hot.setDataAtCell(window.wpseCurrentPopupSourceCoords.row,window.wpseCurrentPopupSourceCoords.col,JSON.stringify(n)),r.modalSettings.edit_modal_save_action.split(",").forEach(function(e){if(-1<e.indexOf("js_function_name:")){var t=e.replace("js_function_name:","");vgseExecuteFunctionByName(t,o.find("iframe")[0].contentWindow)}else jQuery.post(ajaxurl,{action:e,nonce:a,postId:r.modalSettings.post_id,postType:r.modalSettings.post_type,modalSettings:r.modalSettings,data:n},function(e){})}),jQuery(".custom-modal-editor").remodal().close(),loading_ajax({estado:!1})}),jQuery(document).on("closed",".custom-modal-editor",function(){var e=window.vgseWCAttsCurrent,t=jQuery(".custom-modal-editor");"metabox"===e.modalSettings.type&&void 0!==window.vgcaIsFrontendSession&&window.vgcaIsFrontendSession.length&&(t.find("iframe").attr("src",""),t.find(".vgca-iframe-wrapper ").hide(),window.vgcaIsFrontendSession.forEach(function(e,t){clearInterval(e)})),jQuery(".custom-modal-editor").removeClass("modal-editor-"+e.modalSettings.key),loading_ajax({estado:!1})}),jQuery(document).on("opened",".custom-modal-editor",function(){var t=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),!t)return!0;var e=jQuery(".custom-modal-editor");if(e.find(".modal-post-title").length||e.find(".modal-general-title").after('<span class="modal-post-title"></span>'),e.find(".modal-post-title").html(t.modalSettings.post_title),t.modalSettings.edit_modal_title&&e.find(".modal-general-title").html(t.modalSettings.edit_modal_title+": "),t.modalSettings.edit_modal_description&&e.find(".modal-description").html(t.modalSettings.edit_modal_description),window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[t.modalSettings.post_id]||(window.hotModalCache[t.modalSettings.post_id]={}),t.modalSettings.edit_modal_get_action){var o=jQuery(".remodal-bg").data("nonce");jQuery.get(ajaxurl,{action:t.modalSettings.edit_modal_get_action,nonce:o,postId:t.modalSettings.post_id}).done(function(e){initHandsontableForPopup(e.data,t.modalSettings)})}else{if(window.hotModalCache&&window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action])var a=window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action];else a=t.existing;initHandsontableForPopup(a,t.modalSettings)}}),jQuery("body").on("click","button.remodal-confirm, a.remodal-cancel, .media-button-insert",function(e){"submit"===jQuery(this).attr("type")||jQuery(this).hasClass("submit")||e.preventDefault()})}),jQuery(document).ready(function(){jQuery(".vgse-current-filters").on("click",".button",function(e){e.preventDefault();var t=jQuery(this),o=hot.getSourceData();if((o=beGetModifiedItems(o,window.beOriginalData)).length)return alert(vgse_editor_settings.texts.save_changes_before_remove_filter),!0;var a=[];t.hasClass("remove-all-filters")?(jQuery(".vgse-current-filters .button:not(.remove-all-filters)").each(function(){a.push(jQuery(this).data("filter-key"))}),jQuery(".vgse-current-filters .button").remove(),jQuery("body").data("be-filters",{})):(a.push(t.data("filter-key")),t.remove()),a.forEach(function(e){e&&(jQuery("#be-filters").find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e&&"checkbox"!==jQuery(this).attr("type")}).val("").trigger("change"),jQuery("#be-filters").find("input:checkbox").filter(function(){return jQuery(this).attr("name")===e}).prop("checked",!1).trigger("change"),beAddRowsFilter(e+"="))}),vgseReloadSpreadsheet()})}),jQuery(document).ready(function(){var o=jQuery(".post-type-setup-wizard");if(!o.length)return!1;o.find("form.inline-add").submit(function(e){var t=jQuery(this),o=t.data("callback");return jQuery.ajax({method:t.attr("method"),url:t.attr("action"),data:t.serialize()+"&current_post_type="+jQuery(".post-types-form input:radio:checked").val()}).done(function(e){t.find("input:text").val(""),t.find("input:text").first().focus(),vgseExecuteFunctionByName(o,window,{response:e,form:t})}),!1});var e=o.find(".post-types-form").data("custom-post-types").split(",");jQuery.each(e,function(e,t){o.find(".post-types-form .post-type-"+t).append('<button class="button vgse-delete-post-type" data-post-type="'+t+'"><i class="fa fa-remove"></i></button>')}),o.on("click",".vgse-delete-post-type",function(e){e.preventDefault();var t=jQuery(this).data("post-type");if(!confirm(o.find(".post-types-form").data("confirm-delete")))return!0;jQuery.post(ajaxurl,{post_type:t,action:"vgse_delete_post_type",nonce:jQuery(".post-type-setup-wizard").data("nonce")},function(e){e.success&&(notification({mensaje:e.data.message,tipo:"success",tiempo:3e3}),o.find(".post-types-form .post-type-"+t).remove())})})}),jQuery(document).ready(function(){var t=jQuery(".quick-setup-page-content .post-type-field input");if(!t.length)return!1;var o=jQuery(".quick-setup-page-content .post-types-enabled");t.change(function(e){o.empty(),t.each(function(){var e=jQuery(this).val();if(jQuery(this).is(":checked")){var t='<a class="button post-type-'+e+'" href="admin.php?page=vgse-bulk-edit-'+e+'">Edit '+jQuery(this).siblings("label").text()+"</a> - ";o.append(t)}})})});
jQuery(document).ready(function(){if("undefined"==typeof hot)return!0;hot.updateSettings({cells:function(t,e,o){var s={},n=vgse_editor_settings.final_spreadsheet_columns_settings[o];if(n){if(!n.is_locked&&(vgse_editor_settings.watch_cells_to_lock||"post_status"===o))if((i=hot.getDataAtCell(t,e))&&"string"==typeof i&&-1<i.indexOf("vg-cell-blocked"))s.readOnly=!0,s.editor=!1,s.renderer="wp_locked",s.fillHandle=!1,"product_variation"===(_=hot.getDataAtRowProp(t,"post_type"))&&vgse_editor_settings.texts.column_for_parent_products_only?s.comment={value:vgse_editor_settings.texts.column_for_parent_products_only}:"product"===_&&vgse_editor_settings.texts.column_for_variations_only&&(s.comment={value:vgse_editor_settings.texts.column_for_variations_only});if(n.is_locked&&n.allow_to_save&&-1<vgse_editor_settings.lockedColumnsManuallyEnabled.indexOf(o)&&((s=n.formatted).readOnly=!1,s.fillHandle=!0,s.renderer="text"),vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&"post_status"===o){s.selectOptions=n.formatted.selectOptions;var _,i=hot.getDataAtCell(t,e);"product_variation"===(_=hot.getDataAtRowProp(t,"post_type"))&&(s.selectOptions={publish:s.selectOptions.publish,delete:s.selectOptions.delete})}}return s}})});