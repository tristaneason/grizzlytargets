"use strict";var _createClass=function(){function n(e,r){for(var a=0;a<r.length;a++){var n=r[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,r,a){return r&&n(e.prototype,r),a&&n(e,a),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}!function(){jQuery(function(a){return window.WC_Authorize_Net_Accept_Hosted_Handler=(_createClass(n,[{key:"handle_iframe_response",value:function(e,r){var a,n;if(r===this.params.form_url&&null!=(a=this.parse_query(n=e)).action)switch(a.action){case"resizeWindow":if(null!=a.height)return this.resize_frame(a.height);break;case"cancel":return this.cancel_transaction();case"transactResponse":return this.process_transaction(n)}}},{key:"parse_query",value:function(e){for(var r,a,n={},t=e.split("&"),i=r=0,o=t.length;0<=o?r<o:o<r;i=0<=o?++r:--r)n[(a=t[i].split("="))[0]]=unescape(a[1]);return n}},{key:"process_transaction",value:function(e){var t,i=this;return this.block_ui(),e=e.split("response=").pop(),(t=JSON.parse(e)).nonce=this.params.response_nonce,t.order_id=this.params.order_id,a.ajax({type:"POST",url:this.params.response_url,data:t}).done(function(e){var r;return"2"===(r=t.responseCode)||"3"===r?i.handle_error():(r=null!=e.data&&e.data.redirect_url?e.data.redirect_url:i.params.order_received_url,window.location=r)}).fail(function(e,r,a){var n;return"2"===(n=t.responseCode)||"3"===n?i.handle_error():window.location=i.params.order_received_url})}},{key:"cancel_transaction",value:function(){return this.block_ui(),window.location=this.params.order_pay_url}},{key:"resize_frame",value:function(e){return this.iframe.height(e)}},{key:"handle_error",value:function(){return window.location=this.params.order_pay_url}},{key:"block_ui",value:function(){return a("body").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}},{key:"unblock_ui",value:function(){return a("body").unblock()}}]),n);function n(e){var r=this;_classCallCheck(this,n),this.process_transaction=this.process_transaction.bind(this),this.params=e,this.token_form=a("#wc-"+this.params.id_dasherized+"-send-token"),this.iframe=a("#wc-"+this.params.id_dasherized+"-iframe"),this.block_ui(),this.token_form.submit(),this.iframe.load(function(){return r.token_form.remove(),r.iframe.show(),a("html, body").animate({scrollTop:r.iframe.offset().top},1e3),r.unblock_ui()})}})}.call(void 0);